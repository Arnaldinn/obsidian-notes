
Uma t√©cnica fundamental em pentests internos √© capturar **hashes NTLMv1/v2** enviados automaticamente pelos hosts de uma rede Windows.  
Para isso, utilizamos o **Responder**, uma ferramenta que explora falhas nos protocolos **LLMNR**, **NBT-NS**, **MDNS** e comportamento inseguro no **SMB** e **HTTP**.

O objetivo √© responder √†s requisi√ß√µes enviadas pelos computadores na rede, se passando pelo servidor desejado, e assim coletar credenciais.

---

# üì° Protocolos envolvidos (explica√ß√£o simples)

## **LLMNR (Link-Local Multicast Name Resolution)**  
- Protocolo de resolu√ß√£o de nomes usado quando o DNS falha.  
- Baseado em multicast na rede local.  
- Muito comum em ambientes Windows antigos.  
- Vulner√°vel porque confia em qualquer host que responda mais r√°pido.

‚û° O Responder finge ser o servidor procurado e recebe o hash NTLM.

---

## **NBT-NS (NetBIOS Name Service)**  
- Sistema legado de resolu√ß√£o de nomes usado pelo Windows.  
- Envia broadcast para descobrir o nome de uma m√°quina em redes locais.  
- √â extremamente antigo e inseguro.

‚û° F√°cil de envenenar: o Responder responde que ‚Äúeu sou o servidor que voc√™ procura‚Äù.

---

## **mDNS (Multicast DNS)**  
- Vers√£o multicast do DNS usada por Linux/macOS e dispositivos IoT.  
- Tamb√©m tenta descobrir servi√ßos automaticamente na rede.

‚û° O Responder pode responder se configurado, capturando tentativas de autentica√ß√£o.

---

## **SMB (Server Message Block)**  
- Protocolo de compartilhamento de arquivos e impressoras do Windows.  
- Alguns softwares enviam hashes automaticamente ao tentar montar caminhos UNC (ex: `\\SERVIDOR\pasta`).

‚û° O Responder abre um servidor SMB falso para aceitar essas conex√µes e coletar NTLM.

---

## **HTTP (Fake Webserver)**  
- Muitos aplicativos tentam fazer autentica√ß√£o via HTTP.  
- O Responder cria um servidor HTTP que solicita NTLM, fazendo m√°quinas enviarem hashes.

‚û° Muito √∫til para capturar NTLMv2 sem intera√ß√£o do usu√°rio.

---

# üìä Tabela resumida

| Protocolo | Fun√ß√£o | Explor√°vel pelo Responder | Vulner√°vel por padr√£o? |
|----------|--------|---------------------------|-------------------------|
| **LLMNR** | Resolver nomes quando DNS falha | ‚úî Sim | ‚úî Sim |
| **NBT-NS** | Sistema legado de nomes Windows | ‚úî Sim | ‚úî Sim |
| **mDNS** | Descoberta de servi√ßos | ‚úî Sim (opcional) | Parcial |
| **SMB** | Compartilhamento de arquivos | ‚úî Sim | Depende da config |
| **HTTP** | Autentica√ß√£o em webservices | ‚úî Sim | Sim |

---

# ‚öôÔ∏è Como capturar hashes com o Responder

## **Comando principal**

```
sudo responder -I eth0 -Pv
```


**PROXIMA ETAPA III - Valida√ß√£o de Credenciais**


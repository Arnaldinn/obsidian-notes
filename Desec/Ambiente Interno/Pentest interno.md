
**Primeiro passo: Identificar o escopo da rede!

Comece utilizando nmap em portas abertas, em casos de SMB, especificar na porta 445, pelo fato de ser comprometer um domínio LOCAL (AD)

```
nmap --open -v -sS -p 445 -Pn 172.16.1.0/24 -oG smb.txt
```

Para uma saída mais limpa(Apenas os IPS):
```
cat smb.txt | grep "Up" | cut -d " " -f 2 > targets
```

Para realizar uma varredura completa de uma forma mais rápida e eficiente, 'e bom utilizar o **CrackMapExec (CME)** é uma ferramenta poderosa usada para **auditoria de redes Windows** e ataques em ambientes Active Directory (AD). Ele permite testar credenciais, explorar compartilhamentos SMB, executar comandos remotamente e automatizar ataques pós-exploração.

```
crackmapexec smb targets 
```

Apenas com esses comandos já foi possível identificar os IPS que fazem parte da constituição local!

Exemplos de saída:
```
SMB         172.16.1.253    445    CORPPC02         [*] Windows 10 / Server 2019 Build 18362 x64 (name:CORPPC02) (domain:ORIONSCORP2.LOCAL) 
SMB         172.16.1.243    445    SERVAD02         [*] Windows 10 / Server 2019 Build 17763 x64 (name:SERVAD02) (domain:ORIONSCORP2.LOCAL) 
SMB         172.16.1.245    445    CORPPC01         [*] Windows 10 / Server 2019 Build 18362 x64 (name:CORPPC01) (domain:ORIONSCORP2.LOCAL)
```

Apos isso e uma boa pratica realizar um nmap no SERVAD encontrado !


**PARTE II - CAPTURANDO HASHES NA REDE**